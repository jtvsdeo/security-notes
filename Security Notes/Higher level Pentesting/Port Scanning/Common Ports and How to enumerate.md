# Common Ports 
## How to enumerate and what to do with them


### Nmap Scans
`-sT` TCP scan  
`-sU` UDP scan  
`-sS` Syn scan  
`-sn` Network Sweep  
`-O` OS Guessing  
`-sV` Service Banners  
`-A` Aggresive scanning  
`-p-` All ports  
`--Script=` Nmap Scripts, stored in `/usr/share/nmap/scripts/`
Can also run: `nmap --script vuln <ip>`

#### 21 FTP 
`ftp <ip>`
Check for anonymous login
See if you can download/upload or exec backdoor code?  


#### 22 SSH 
`ssh user@ip -i id_rsa`

Bruteforce with Hydra

**Error:** Unable to negotiate with 10.10.10.7 port 22: no matching key exchange method found. Their offer: diffie-hellman-group-exchange-sha1,diffie-hellman-group14-sha1,diffie-hellman-group1-sha1

**Solution:** `ssh -oKexAlgorithms=+diffie-hellman-group1-sha1 user@legacyhost`


#### 23 Telnet
No password? GG


#### 25 SMTP
Server to server service. User sends mail using imap or pop3.
These messages router to SMTP server

Use `VRFY` command and run scripts to check for users

**Can manually access using nc:** 
` nc <host> 25`

**Check what commands are available:**
`nmap -script smtp-commands.nse 192.168.1.101`

**Enumerate for users:**
`smtp-user-enum -M VRFY -U /root/sectools/SecLists/Usernames/Names/names.txt -t <host>`


## 53 DNS
`nslookup` to check for other domain names
Check for zone transfers: `dig axfr @<ip> <abc.com>`   
Make sure abc.com in /etc/hosts


#### 135 MSRPC
 Windows RPC Port
 `nmap <host> —script=msrpc-enum`
 `msf > use exploit/windows/dcerpc/ms03_026_dcom`
 `rpc -N -U "" <ip>`


#### 88 Kerbros-Sec
`kerbrute`


#### 110 POP3
Connected with SMTP, used to retreive emails
`telnet <ip> 110`  
`USER username`  
`PASS password`

#### 111/2049 RPCbind/NFS
Network File system
`showmount -e` to query the mount daemon on a remote host for info about the state of the NFS server on that machine. Lists potential shares
`rpcinfo -p <ip>` to check for shares. Ususally only care for NFS shares so grep nfs

If showmount says /home can be viewed, run the following command to mount the home dir.
```
kali@kali:~$ mkdir home1 
kali@kali:~$ sudo mount -o nolock 10.11.1.72:/home ~/home1/
```
If there are files that only certain users with certian UUID's can read, create a new user on localbox with that UUID.  

**Nmap scan:**  
`nmap -p 111 --script=nfs-ls,nfs-statfs,nfs-showmount 10.10.185.215`  
`--script=rpcinfo`  
`--script=nfs*`

#### 135 MSRPC 
`rpcdump`
`rpcinfo`  

**Nmap Scan:**  
`nmap 192.168.0.101 --script=msrpc-enum`


#### 139/445 SMB/NetBIOS
Access files

**smbclient**
-N no login
-L list shares
-U user
`smbclient -N -L <ip>`
`smbclient \\\\<ip>\\directory `
**Check if you can put files and then access through a webdir**

**nmap scripts**
`nmap -p445 --script smb-vuln-*`
`--script=smb-os-discovery 10.11.1.227`

**Others**
`nbtscan -v <ip>`
`enum4linux <ip>`

#### 161 SNMP
UDP Port
Linux: Use tool `onesixtyone` to bruteforce community strings
```
kali@kali:~$ echo public > community kali@kali:~$ echo private >> community kali@kali:~$ echo manager >> community kali@kali:~$ for ip in $(seq 1 254); do echo 10.11.1.$ip; done > ips kali@kali:~$ onesixtyone -c community -i ips
```
Once we find snmp services, we can query for MIB Data  

Windows: `snmpwalk` 
Can get windows users and processes.

#### 443 HTTPS
Check if there is a different site here
SSL Bug Heartbleed  


#### 3306 MySQL
Default creds `root:root`  

**Nmap Script:**  
`nmap --script=mysql-enum <ip>`

**Cheat Sheet:**
`http://cse.unl.edu/~sscott/ShowFiles/SQL/CheatSheet/SQLCheatSheet.html`

Can dump DB, hashes or get version
If root runs this, we can privesc 

#### 3389 RDP
`rdesktop -u guest -p guest <ip>`  
**Brute Force:**  
`ncrack -vv --user Administrator -P /root/passwords.txt rdp://192.168.1.101`


#### 6379 Redis 
Check if you can upload files, might want to try to upload a webshell or ssh key
Can use redis-tools → commands online
