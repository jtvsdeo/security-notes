# Priv Esc for Windows


### Users  
`whoami`  
To discover other users: `net user`  
To gain info on other users: `net user <username>` 


### Hostname
Hostname provides functional roles: `hostname`

### OS Version and Architecture
`systeminfo | findstr /B /C:"OS Name" /C:"OS Version" /C:"System Type"`

### Running Processes
`tasklist /SVC`

###  Network Info 
In need to pivot or find other hidden networks: `ipconfig /all` 
Check routing tables: `route print`
Active TCP network connections with address and PID: `netstat -ano`
Firwall status and rules: `netsh advfirewall show currentprofile`
If firewall profile is active, we can list the rules: `netsh advfirewall firewall show rule name=all`

### Scheduled tasks
`schtasks /query /fo LIST /v`


### Installed Apps and Patch 
Package  manager = wmic `wmic product get name, version, vendor` 
Check if it has been updated recently: `wmic qfe get Caption, Description, HotFixID, InstalledOn` 

### Insecure File permissions
`accesschk.exe -uws "Everyone" "C:\Program Files"`


### Unmounted Disks
`mountvol`

### Device Drivers and kernel modules

**Using powershell**  
`driverquery.exe /v /fo csv | ConvertFrom-CSV | Select-Object ‘Dis play Name’, ‘Start Mode’, Path`
Load VMware drivers with specific versions and then search for exploits:
`Get-WmiObject Win32_PnPSignedDriver | Select-Object DeviceName, D riverVersion, Manufacturer | Where-Object {$_.DeviceName -like "*VMware*"}`

### Find Binaries that autoelevate (SUID bit equivalent)
Need to check for `AlwaysInstallElevated` registry setting
`reg query HKEY_CURRENT_USER\Software\Policies\Microsoft\Windows\Installer`

### Automated
`windows-privesc-check` script by pentestmonkey

620