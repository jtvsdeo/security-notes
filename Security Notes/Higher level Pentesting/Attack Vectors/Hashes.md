# Hashes

To check what hash it is, can use `hashid` command.
Hash lookup `hashkiller` website

### Windows
Hashed passwords stored in `Security Accounts Manager`  
Uses NTLM after windows vista, stored in SAM database, not salted.  

SAM database cannot be copied while the operating system is running because the Windows kernel keeps an exclusive file system lock on the file. However, we can use mimikatz to dump the hashes. It extracts from LSASS where the hashes are cached. Need to launch mimikatz from admin cmd since LSASS runs as system. 

Commands to dump hashes:
`privilege::debug` > enables the SeDebugPrivilge access right required to tamper with another process  
`token::elevate` elevate token from high integrity to system
`lsadump::sam`  to dump SAM database

**Passing the Hash**    
If you have a hash, you can use it to authenticate to multiple targets. NTLM does not salt the hashes  
Program to do this: pth-winexe

### Password cracking with JohnTheRipper JTR
If you have /etc/passwd and /etc/shadow:  The `unshadow` command will basically combine the data of /etc/passwd and /etc/shadow to create 1 file with username and password details.  
`john hash.txt`  
 
If ssh key is encrypted: First we’ll need to generate the hash using ssh2john:  
`/usr/share/john/ssh2john.py id_rsa >id_rsa2`  
 
`john id_rsa2 --wordlist=/home/kali/freqFiles/rockyou.txt`  


