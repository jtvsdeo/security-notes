

### SSH Local Port Forwarding - Binds attacker port to victim port
> Traffic sent through attacker port is forwarded to victim port. If victim is running port 80 internally, can bind their 80 to attacker machine. So attacker can send get request to their 80 and it gets forwarded to victims port 80. 

![](../../Assets/Pasted%20image%2020220731231013.png)

We can either access the MySQL service by SSH'ing to the server or we can port forward it on our localhost and access it locally.
Benefit of accessing it locally is we can execute a remote exploit on the MYSQL Service

`ssh -L 1234:localhost:3306 Ubuntu@10.129.202.64`

**Another Syntax:**
`ssh -N -L [bind_address:]port:host:hostport [username@address]`
Example: `sudo ssh -N -L 0.0.0.0:80:127.0.0.1:80 student@192.168.180.52 -p 2222
`  
In the case above, 192.168.180.52 is running an webserver with internal access only, that is now binded to attacking machine:80

-L tells SSH client to request server to forward all data we send via port 1234 to localhost:3306 (localhost is ubuntu ) Now we can access MySQL on 1234.

 If we want to forward multiple ports from the Ubuntu server to your localhost, you can do so by including the `local port:server:port` argument to your ssh command. For example, the below command forwards the apache web server's port 80 to your attack host's local port on 8080.

`ssh -L 1234:localhost:3306 8080:localhost:80 ubuntu@10.129.202.64`



### SSH Remote Port Forwarding - Binds victim machine port to attacker port

> If there is something that connects to victim port that the attacker would like to listen to on their port.

**Scenario:**  The victim  machine has an exploit that is triggered by root every minute that executes a basic reverse shell to the internal port 5555 on 127.0.0.1 on that server, and the server has no tools available to catch this shell. 

`ssh -N -R [bind_address:]port:host:hostport [username@address]`  
Example: `ssh -N -R 192.168.180.52:5555:127.0.0.1:4444 student@192.168.180.52 -p 2222`


## Dynamic Port Forwarding with SSH and SOCKS Tunneling

> Port forwarding is a technique that allows us to redirect a communication request from one port to another. 

`ssh -N -D <address to bind to>:<port to bind to> <username>@<SSH server address>`
Add the following the /etc/proxychains.conf: `socks4 	127.0.0.1 8080`
Example: `sudo ssh -N -D 127.0.0.1:8080 student@10.11.0.128`

If you want to check internal ports: `sudo proxychains nc -zv 127.0.0.1 30000-35000`
Cannot use the external IP since the port might be open on another interface